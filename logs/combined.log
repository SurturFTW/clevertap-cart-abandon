{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:14:46.928Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:14:46.930Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:00 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:14:46.930Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:14:46.930Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:20:38.294Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:23:33.424Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:23:33.425Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:00 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:23:33.425Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:23:33.426Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:26:31.428Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:26:34.199Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:26:34.200Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:00 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:26:34.200Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:26:34.200Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:00 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:30:00.426Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T10:30:00.428Z"}
{"$metadata":{"attempts":1,"totalRetryDelay":0},"level":"error","message":"Error fetching CSV data from cart-abandon: Resolved credential object is not valid","service":"clevertap-processor","stack":"Error: Resolved credential object is not valid\n    at SignatureV4S3Express.validateResolvedCredentials (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:456:13)\n    at SignatureV4S3Express.signRequest (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:596:10)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async AwsSdkSigV4Signer.sign (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/core/dist-cjs/submodules/httpAuthSchemes/index.js:108:27)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:482:15\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22","timestamp":"2025-06-04T10:30:00.447Z"}
{"$metadata":{"attempts":1,"totalRetryDelay":0},"level":"error","message":"Cron Job 1 failed: Resolved credential object is not valid","service":"clevertap-processor","stack":"Error: Resolved credential object is not valid\n    at SignatureV4S3Express.validateResolvedCredentials (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:456:13)\n    at SignatureV4S3Express.signRequest (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:596:10)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async AwsSdkSigV4Signer.sign (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/core/dist-cjs/submodules/httpAuthSchemes/index.js:108:27)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:482:15\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22","timestamp":"2025-06-04T10:30:00.447Z"}
{"$metadata":{"attempts":1,"totalRetryDelay":0},"level":"error","message":"Scheduled Cron Job 1 failed: Resolved credential object is not valid","service":"clevertap-processor","stack":"Error: Resolved credential object is not valid\n    at SignatureV4S3Express.validateResolvedCredentials (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:456:13)\n    at SignatureV4S3Express.signRequest (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/signature-v4/dist-cjs/index.js:596:10)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async AwsSdkSigV4Signer.sign (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/core/dist-cjs/submodules/httpAuthSchemes/index.js:108:27)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:482:15\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22","timestamp":"2025-06-04T10:30:00.447Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:32:54.865Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:40:48.003Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:40:48.086Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:40:48.086Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:00 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:40:48.086Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:40:48.086Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:43:23.145Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:44:21.068Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:44:21.140Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:44:21.140Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:44:21.140Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:44:21.140Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:45:00.195Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T10:45:00.196Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:45:00.776Z"}
{"level":"info","message":"Processing file: 1749031435-1749031435-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:45:00.776Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","httpStatusCode":403,"requestId":"HSG1VF3WH506PX5V","totalRetryDelay":0},"Code":"AccessDenied","HostId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","RequestId":"HSG1VF3WH506PX5V","level":"error","message":"Error fetching CSV data from cart-abandon: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-04T10:45:00.939Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","httpStatusCode":403,"requestId":"HSG1VF3WH506PX5V","totalRetryDelay":0},"Code":"AccessDenied","HostId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","RequestId":"HSG1VF3WH506PX5V","level":"error","message":"Cron Job 1 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-04T10:45:00.940Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","httpStatusCode":403,"requestId":"HSG1VF3WH506PX5V","totalRetryDelay":0},"Code":"AccessDenied","HostId":"fC126toWJB4wK+3gQ2ks7Q3MZ0Cd75613MPb3hBaZoKk2HVgKlyh+PghD+Br94lADR5roV1Mtew=","RequestId":"HSG1VF3WH506PX5V","level":"error","message":"Scheduled Cron Job 1 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:GetObject on resource: \"arn:aws:s3:::cart-abandon/1749031435-1749031435-AddToCart-20250604-0-21.csv.gz\" because no identity-based policy allows the s3:GetObject action\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-04T10:45:00.941Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:48:00.426Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T10:48:00.427Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T10:48:00.988Z"}
{"level":"warn","message":"No CSV files found in delta events bucket","service":"clevertap-processor","timestamp":"2025-06-04T10:48:00.988Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T10:48:00.988Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:51:00.418Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:51:02.807Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:51:02.857Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:51:02.857Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:51:02.857Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:51:02.857Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:52:00.925Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T10:52:00.926Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:52:01.529Z"}
{"level":"info","message":"Processing file: 1749031435-1749031435-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:52:01.529Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.244Z"}
{"level":"info","message":"Processing file: 1749031653-1749031653-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.244Z"}
{"level":"info","message":"Cart abandon records: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.412Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.412Z"}
{"level":"info","message":"Delta records (after filtering): 0","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.412Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-04T10:52:02.413Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:55:00.136Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T10:55:00.136Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T10:55:00.681Z"}
{"level":"warn","message":"No CSV files found in delta events bucket","service":"clevertap-processor","timestamp":"2025-06-04T10:55:00.681Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T10:55:00.681Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:55:50.522Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:58:07.662Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:58:07.748Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:58:07.748Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:58:07.749Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:58:07.749Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T10:58:14.379Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:58:28.335Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T10:58:28.402Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T10:58:28.403Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:58:28.403Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T10:58:28.403Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T10:59:00.437Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T10:59:00.439Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:59:01.110Z"}
{"level":"info","message":"Processing file: 1749031435-1749031435-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T10:59:01.111Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T10:59:01.890Z"}
{"level":"info","message":"Processing file: 1749031653-1749031653-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T10:59:01.891Z"}
{"level":"info","message":"=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.085Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.085Z"}
{"level":"info","message":"Sample record:","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"Sample record:","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.087Z"}
{"level":"info","message":"\nUnique charged identities found: 1","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"Cart abandon records: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"Delta records (after deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-04T10:59:02.088Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T11:00:00.548Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T11:00:00.551Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T11:00:01.154Z"}
{"level":"warn","message":"No CSV files found in delta events bucket","service":"clevertap-processor","timestamp":"2025-06-04T11:00:01.154Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T11:00:01.155Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T11:09:38.024Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T11:51:35.050Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T11:51:35.129Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T11:51:35.129Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T11:51:35.129Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T11:51:35.129Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T11:53:00.228Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T11:53:00.230Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T11:53:00.869Z"}
{"level":"info","message":"Processing file: 1749031435-1749031435-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T11:53:00.870Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.020Z"}
{"level":"info","message":"Processing file: 1749031653-1749031653-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.020Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.188Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.188Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"ts: 20250604134942","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.189Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.190Z"}
{"level":"info","message":"eventProps.price: 3999","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"ts: 20250604135145","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.191Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.192Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.193Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.194Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.194Z"}
{"level":"info","message":"ts: 20250604114704","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.194Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.196Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.197Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.198Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.199Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.199Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.199Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.199Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.price: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.image_url: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.product_id: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"ts: 20250604135853","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.200Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.201Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.202Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.202Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.202Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.202Z"}
{"level":"info","message":"Unique charged identities found: 1","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"Cart abandon records: 2","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"Delta records (after deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-04T11:53:02.203Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T11:54:00.355Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T11:54:00.356Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T11:54:00.959Z"}
{"level":"warn","message":"No CSV files found in delta events bucket","service":"clevertap-processor","timestamp":"2025-06-04T11:54:00.960Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T11:54:00.960Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T11:54:19.724Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T12:16:24.351Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T12:16:24.428Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T12:16:24.428Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T12:16:24.428Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T12:16:24.428Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T12:18:00.543Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T12:18:00.545Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.107Z"}
{"level":"info","message":"Processing file: 1749038653-1749038653-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.107Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.751Z"}
{"level":"info","message":"Processing file: 1749038674-1749038674-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.751Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.931Z"}
{"level":"info","message":"Total records received: 3","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.931Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.931Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"ts: 20250604134942","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.price: 3999","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"ts: 20250604135145","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.932Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"ts: 20250604114704","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.price: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.image_url: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.product_id: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"ts: 20250604135853","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.933Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"\n=== Processing Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Unique identity-product combinations in charged events: 1","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Cart abandon records: 3","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Delta records (before deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Delta records (after deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"\n=== Sample Filtered Data ===","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"First record after filtering:","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"info","message":"Product ID: 123a","service":"clevertap-processor","timestamp":"2025-06-04T12:18:01.934Z"}
{"level":"error","message":"Cron Job 1 failed: s3Service.uploadCsv is not a function","service":"clevertap-processor","stack":"TypeError: s3Service.uploadCsv is not a function\n    at CronJob1.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:24:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:41:9)","timestamp":"2025-06-04T12:18:01.936Z"}
{"level":"error","message":"Scheduled Cron Job 1 failed: s3Service.uploadCsv is not a function","service":"clevertap-processor","stack":"TypeError: s3Service.uploadCsv is not a function\n    at CronJob1.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:24:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:41:9)","timestamp":"2025-06-04T12:18:01.936Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T12:19:00.663Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T12:19:00.664Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T12:19:01.191Z"}
{"level":"warn","message":"No CSV files found in delta events bucket","service":"clevertap-processor","timestamp":"2025-06-04T12:19:01.192Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T12:19:01.192Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T12:42:10.932Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T12:43:07.706Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T12:43:07.785Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T12:43:07.785Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T12:43:07.785Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T12:43:07.785Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T12:44:00.848Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T12:44:00.851Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T12:44:01.459Z"}
{"level":"info","message":"Processing file: 1749038653-1749038653-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T12:44:01.460Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.426Z"}
{"level":"info","message":"Processing file: 1749038674-1749038674-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.426Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.607Z"}
{"level":"info","message":"Total records received: 3","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.607Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.608Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.608Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.608Z"}
{"level":"info","message":"ts: 20250604134942","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.608Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.609Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventProps.price: 3999","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"ts: 20250604135145","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.610Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.611Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.612Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"ts: 20250604114704","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.613Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.price: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.image_url: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.product_id: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.614Z"}
{"level":"info","message":"ts: 20250604135853","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.615Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.616Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.617Z"}
{"level":"info","message":"\n=== Processing Details ===","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Unique identity-product combinations in charged events: 1","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Cart abandon records: 3","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Delta records (before deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Delta records (after deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"\n=== Sample Filtered Data ===","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"First record after filtering:","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.618Z"}
{"level":"info","message":"Identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.619Z"}
{"level":"info","message":"Product ID: 123a","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.619Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-04T12-44-02-619Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T12:44:02.619Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-04T12-44-02-619Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T12:44:03.316Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-04T12-44-02-619Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T12:44:03.317Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 2 records in 2466ms","service":"clevertap-processor","timestamp":"2025-06-04T12:44:03.317Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T12:45:00.968Z"}
{"level":"info","message":"Starting Cron Job 2 - CleverTap Upload","service":"clevertap-processor","timestamp":"2025-06-04T12:45:00.970Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T12:45:01.819Z"}
{"level":"info","message":"Processing delta file: delta_2025-06-04T12-44-02-619Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T12:45:01.819Z"}
{"level":"error","message":"Error fetching delta CSV data: s3Service.downloadCsv is not a function","service":"clevertap-processor","stack":"TypeError: s3Service.downloadCsv is not a function\n    at CronJob2.fetchLatestDeltaData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:68:48)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob2.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:14:31)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:54:9)","timestamp":"2025-06-04T12:45:01.821Z"}
{"level":"error","message":"Cron Job 2 failed: s3Service.downloadCsv is not a function","service":"clevertap-processor","stack":"TypeError: s3Service.downloadCsv is not a function\n    at CronJob2.fetchLatestDeltaData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:68:48)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob2.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:14:31)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:54:9)","timestamp":"2025-06-04T12:45:01.822Z"}
{"level":"error","message":"Scheduled Cron Job 2 failed: s3Service.downloadCsv is not a function","service":"clevertap-processor","stack":"TypeError: s3Service.downloadCsv is not a function\n    at CronJob2.fetchLatestDeltaData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:68:48)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob2.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob2.js:14:31)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:54:9)","timestamp":"2025-06-04T12:45:01.822Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:27:18.829Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:27:18.907Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T16:27:18.907Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:27:18.907Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:27:18.907Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T16:29:00.014Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T16:29:00.651Z"}
{"level":"warn","message":"No CSV files found for today (20250604) in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T16:29:00.651Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T16:29:00.651Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T16:31:40.980Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:31:43.136Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:31:43.186Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T16:31:43.186Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:31:43.186Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:31:43.186Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T16:33:00.268Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T16:33:00.271Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T16:33:00.859Z"}
{"level":"info","message":"Processing file: 1749038653-1749038653-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T16:33:00.859Z"}
{"level":"error","message":"Error fetching CSV data from cart-abandon: zlib is not defined","service":"clevertap-processor","stack":"ReferenceError: zlib is not defined\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:48:42\n    at new Promise (<anonymous>)\n    at Object.fetchCsvFromS3 (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:43:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob1.fetchLatestCsvData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:72:20)\n    at async CronJob1.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:13:37)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:41:9)","timestamp":"2025-06-04T16:33:01.037Z"}
{"level":"error","message":"Cron Job 1 failed: zlib is not defined","service":"clevertap-processor","stack":"ReferenceError: zlib is not defined\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:48:42\n    at new Promise (<anonymous>)\n    at Object.fetchCsvFromS3 (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:43:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob1.fetchLatestCsvData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:72:20)\n    at async CronJob1.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:13:37)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:41:9)","timestamp":"2025-06-04T16:33:01.038Z"}
{"level":"error","message":"Scheduled Cron Job 1 failed: zlib is not defined","service":"clevertap-processor","stack":"ReferenceError: zlib is not defined\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:48:42\n    at new Promise (<anonymous>)\n    at Object.fetchCsvFromS3 (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/services/s3Service.js:43:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async CronJob1.fetchLatestCsvData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:72:20)\n    at async CronJob1.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob1.js:13:37)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:41:9)","timestamp":"2025-06-04T16:33:01.038Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T16:34:00.377Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T16:34:01.394Z"}
{"level":"warn","message":"No CSV files found for today (2025-06-04) in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T16:34:01.395Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-04T16:34:01.395Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T16:34:11.062Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:34:30.995Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T16:34:31.073Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T16:34:31.073Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:34:31.073Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T16:34:31.073Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T16:36:00.172Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T16:36:00.174Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T16:36:00.786Z"}
{"level":"info","message":"Processing file: 1749038653-1749038653-AddToCart-20250604-0-21.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T16:36:00.786Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.533Z"}
{"level":"info","message":"Processing file: 1749038674-1749038674-Charged-20250604-0-21.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.533Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.697Z"}
{"level":"info","message":"Total records received: 3","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.697Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"ts: 20250604134942","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.698Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.699Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventProps.price: 3999","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"ts: 20250604135145","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.700Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.701Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.702Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.702Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.702Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.702Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.702Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.703Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.703Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.704Z"}
{"level":"info","message":"ts: 20250604114704","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.704Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.704Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.704Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.705Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.price: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.image_url: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.product_id: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"ts: 20250604135853","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.706Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.all_identities: [testing.dev@gmail.com, hello_123]","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.phone: 917202897611","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.name: Dev Testing","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.707Z"}
{"level":"info","message":"profile.email: testing.dev@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"profile.push_token: fcm:cW57dF6URueav7Vw8K3vPR:APA91bFrfdNDJo_c3feheyHdeJuo57G5fs0Wx2_6VsGxRvaRfCb8KDYrg76raBFu10Toc1GrbUjj6QmRt_waqakYHI1EPUNS6JUxQZvH3N3S-77kkotlceI","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.708Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"\n=== Processing Details ===","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"Unique identity-product combinations in charged events: 1","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.711Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Cart abandon records: 3","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Delta records (before deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Delta records (after deduplication): 2","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"\n=== Sample Filtered Data ===","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"First record after filtering:","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Product ID: 123a","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:36:01.712Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:36:02.348Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:36:02.349Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 2 records in 2175ms","service":"clevertap-processor","timestamp":"2025-06-04T16:36:02.349Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T16:37:00.284Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T16:37:00.842Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:37:00.842Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:37:00.843Z"}
{"level":"info","message":"Successfully downloaded and parsed 2 records from delta-events/delta_2025-06-04T16-36-01-712Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T16:37:01.018Z"}
{"level":"info","message":"Extracted 2 valid profiles from 2 records","service":"clevertap-processor","timestamp":"2025-06-04T16:37:01.018Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-04T16:37:01.019Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:37:01.275Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T16:37:01.522Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":2,"timestamp":"2025-06-04T16:37:01.624Z","totalProcessed":2}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T16:43:41.099Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T17:15:04.039Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T17:15:04.111Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T17:15:04.111Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T17:15:04.111Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T17:15:04.112Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T17:16:00.182Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T17:16:00.184Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T17:16:00.821Z"}
{"level":"info","message":"Processing file: 1749056618-1749056618-AddToCart-20250604-0-16.csv.gz from bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T17:16:00.821Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.552Z"}
{"level":"info","message":"Processing file: 1749056639-1749056639-Charged-20250604-0-16.csv.gz from bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.552Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.731Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.731Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.731Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.731Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"ts: 20250604223048","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.732Z"}
{"level":"info","message":"ts: 20250604223132","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.733Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventProps.product_id: 123d","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"ts: 20250604223153","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.734Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"ts: 20250604223236","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.735Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"Valid cart abandon records after null check: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.736Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Original cart abandon records: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Valid cart abandon records: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Delta records (before deduplication): 1","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Final delta records: 1","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:16:01.737Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:16:02.462Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:16:02.462Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 1 records in 2278ms","service":"clevertap-processor","timestamp":"2025-06-04T17:16:02.462Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T17:17:00.307Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T17:17:00.871Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:17:00.871Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:17:00.871Z"}
{"level":"info","message":"Successfully downloaded and parsed 1 records from delta-events/delta_2025-06-04T17-16-01-737Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:17:01.036Z"}
{"level":"info","message":"Extracted 1 valid profiles from 1 records","service":"clevertap-processor","timestamp":"2025-06-04T17:17:01.037Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-04T17:17:01.038Z"}
{"level":"info","message":"CleverTap API success for identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:17:01.486Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":1,"timestamp":"2025-06-04T17:17:01.588Z","totalProcessed":1}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T17:19:54.676Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-04T17:49:37.806Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-04T17:49:37.880Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-04T17:49:37.880Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T17:49:37.880Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-04T17:49:37.880Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-04T17:51:00.974Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-04T17:51:00.976Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T17:51:01.892Z"}
{"level":"info","message":"Searching for files with date: 20250604","service":"clevertap-processor","timestamp":"2025-06-04T17:51:01.893Z"}
{"level":"info","message":"Found 2 files for today in cart-abandon","service":"clevertap-processor","timestamp":"2025-06-04T17:51:01.893Z"}
{"level":"info","message":"Processing file: 1749056618-1749056618-AddToCart-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-04T17:51:01.893Z"}
{"level":"info","message":"Processing file: 1749056618-1749056618-AddToCart-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.057Z"}
{"level":"info","message":"Total records processed from cart-abandon: 5","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.220Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.748Z"}
{"level":"info","message":"Searching for files with date: 20250604","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.748Z"}
{"level":"info","message":"Found 2 files for today in charged-events","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.748Z"}
{"level":"info","message":"Processing file: 1749056639-1749056639-Charged-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.748Z"}
{"level":"info","message":"Processing file: 1749056639-1749056639-Charged-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-04T17:51:02.904Z"}
{"level":"info","message":"Total records processed from charged-events: 4","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.063Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"Total records received: 5","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"ts: 20250604223048","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.064Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"ts: 20250604223132","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.product_id: 123d","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"Total records received: 4","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.065Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"ts: 20250604223153","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"ts: 20250604223236","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.066Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.067Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"Valid cart abandon records after null check: 5","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"Valid charged combinations: 3","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.068Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Original cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Valid cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Charged events records: 4","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Valid charged combinations: 3","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Delta records (before deduplication): 3","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Final delta records: 3","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.069Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.704Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.704Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 3 records in 2728ms","service":"clevertap-processor","timestamp":"2025-06-04T17:51:03.704Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.102Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.616Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.616Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.617Z"}
{"level":"info","message":"Successfully downloaded and parsed 3 records from delta-events/delta_2025-06-04T17-51-03-069Z.csv","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.777Z"}
{"level":"info","message":"Extracted 3 valid profiles from 3 records","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.778Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-04T17:52:00.779Z"}
{"level":"info","message":"CleverTap API success for identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-04T17:52:01.259Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T17:52:01.515Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-04T17:52:01.773Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":3,"timestamp":"2025-06-04T17:52:01.874Z","totalProcessed":3}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-04T17:54:26.512Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-06T06:23:43.711Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-06T06:23:43.774Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-06T06:23:43.774Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-06T06:23:43.774Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-06T06:23:43.774Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-06T06:25:00.878Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-06T06:25:00.879Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-06T06:25:01.854Z"}
{"level":"info","message":"Searching for files with date: 20250606","service":"clevertap-processor","timestamp":"2025-06-06T06:25:01.854Z"}
{"level":"warn","message":"No .csv.gz files found for today (20250606) in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-06T06:25:01.855Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.673Z"}
{"level":"info","message":"Searching for files with date: 20250606","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.673Z"}
{"level":"warn","message":"No .csv.gz files found for today (20250606) in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.673Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Valid cart abandon records after null check: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Original cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Valid cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Charged events records: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.674Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.675Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.675Z"}
{"level":"info","message":"Final delta records: 0","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.675Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.675Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 0 records in 1796ms","service":"clevertap-processor","timestamp":"2025-06-06T06:25:02.675Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-06T06:25:41.114Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-06T06:59:11.391Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-06T06:59:11.465Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-06T06:59:11.465Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-06T06:59:11.465Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-06T06:59:11.465Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-06T07:00:00.542Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-06T07:00:00.545Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.206Z"}
{"level":"info","message":"Searching for files with date: 20250606","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.206Z"}
{"level":"info","message":"Found 2 files for today in cart-abandon","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.207Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.207Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.408Z"}
{"level":"info","message":"Total records processed from cart-abandon: 5","service":"clevertap-processor","timestamp":"2025-06-06T07:00:01.588Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.102Z"}
{"level":"info","message":"Searching for files with date: 20250606","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.102Z"}
{"level":"info","message":"Found 2 files for today in charged-events","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.103Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.103Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.283Z"}
{"level":"info","message":"Total records processed from charged-events: 2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.449Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.449Z"}
{"level":"info","message":"Total records received: 5","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"ts: 20250606121411","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.450Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"ts: 20250606121427","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.451Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"ts: 20250606121454","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.452Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"ts: 20250606121214","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.453Z"}
{"level":"info","message":"profile.identity: furni2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.all_identities: [furni2, dedededed@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.email: dedededed@gmail.com","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.456Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.458Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.458Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.458Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.458Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.459Z"}
{"level":"info","message":"Valid cart abandon records after null check: 5","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.460Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.460Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.460Z"}
{"level":"info","message":"Original cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.460Z"}
{"level":"info","message":"Valid cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.460Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.461Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.461Z"}
{"level":"info","message":"Delta records (before deduplication): 3","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.461Z"}
{"level":"info","message":"Final delta records: 3","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.461Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:00:02.461Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:00:03.222Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:00:03.222Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 3 records in 2677ms","service":"clevertap-processor","timestamp":"2025-06-06T07:00:03.222Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-06T07:01:00.661Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.213Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.214Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.214Z"}
{"level":"info","message":"Successfully downloaded and parsed 3 records from delta-events/delta_2025-06-06T07-00-02-461Z.csv","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.461Z"}
{"level":"info","message":"Extracted 3 valid profiles from 3 records","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.461Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.462Z"}
{"level":"info","message":"Grouped 3 records into 2 unique identities","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.462Z"}
{"level":"info","message":"Sample consolidated profile:","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.462Z"}
{"level":"info","message":"Sending consolidated data for identity: 32rfwq with 1 items","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.463Z"}
{"level":"info","message":"CleverTap API success for identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.817Z"}
{"level":"info","message":"Sending consolidated data for identity: furni2 with 2 items","service":"clevertap-processor","timestamp":"2025-06-06T07:01:01.919Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-06T07:01:02.057Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":2,"timestamp":"2025-06-06T07:01:02.159Z","totalRecords":3,"uniqueIdentities":2}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-06T07:26:37.274Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:12:45.864Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:12:45.930Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-09T11:12:45.930Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:12:45.930Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:12:45.931Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.014Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.016Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.056Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.604Z"}
{"level":"warn","message":"No CSV files found for today (2025-06-09) in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.604Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.604Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.693Z"}
{"level":"info","message":"Searching for files with dates: 20250609","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.693Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250609) in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T11:14:00.693Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Searching for files with dates: 20250609","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250609) in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Valid cart abandon records after null check: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Original cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Valid cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.173Z"}
{"level":"info","message":"Charged events records: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"Final delta records: 0","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 0 records in 1158ms","service":"clevertap-processor","timestamp":"2025-06-09T11:14:01.174Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-09T11:16:05.539Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:16:57.904Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:16:57.981Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-09T11:16:57.981Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:16:57.981Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:16:57.981Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.057Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.059Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.639Z"}
{"level":"info","message":"Searching for files with dates: 20250609, 20250608, 20250607, 20250606, 20250605, 20250604, 20250603","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.639Z"}
{"level":"info","message":"Found 4 files in cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.640Z"}
{"level":"info","message":"Processing file: 1749191222-1749191222-AddToCart-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.640Z"}
{"level":"info","message":"Processing file: 1749191222-1749191222-AddToCart-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:00.809Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.001Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.166Z"}
{"level":"info","message":"Total records processed from cart-abandon: 10","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.329Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.844Z"}
{"level":"info","message":"Searching for files with dates: 20250609, 20250608, 20250607, 20250606, 20250605, 20250604, 20250603","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.844Z"}
{"level":"info","message":"Found 4 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.844Z"}
{"level":"info","message":"Processing file: 1749191356-1749191356-Charged-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:01.845Z"}
{"level":"info","message":"Processing file: 1749191356-1749191356-Charged-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.010Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.176Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.353Z"}
{"level":"info","message":"Total records processed from charged-events: 6","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.804Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.805Z"}
{"level":"info","message":"Total records received: 10","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.805Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.805Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"ts: 20250604223048","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.806Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.807Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"ts: 20250604223132","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.808Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"eventProps.product_id: 123d","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"Total records received: 6","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.809Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"ts: 20250604223153","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.810Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.811Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.814Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.815Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.816Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"ts: 20250604223236","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.818Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.819Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"Valid cart abandon records after null check: 10","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"Valid charged combinations: 5","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.820Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Original cart abandon records: 10","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Valid cart abandon records: 10","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Charged events records: 6","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Valid charged combinations: 5","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Delta records (before deduplication): 6","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Final delta records: 6","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.821Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:18:02.822Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:18:03.457Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:18:03.458Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 6 records in 3399ms","service":"clevertap-processor","timestamp":"2025-06-09T11:18:03.458Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.221Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.722Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.723Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.723Z"}
{"level":"info","message":"Successfully downloaded and parsed 6 records from delta-events/delta_2025-06-09T11-18-02-822Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.899Z"}
{"level":"info","message":"Extracted 6 valid profiles from 6 records","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.899Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.901Z"}
{"level":"info","message":"Grouped 6 records into 4 unique identities","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.901Z"}
{"level":"info","message":"Sample consolidated profile:","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.902Z"}
{"level":"info","message":"Sending consolidated data for identity: hello_321 with 1 items","service":"clevertap-processor","timestamp":"2025-06-09T11:20:00.902Z"}
{"level":"info","message":"CleverTap API success for identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T11:20:02.123Z"}
{"level":"info","message":"Sending consolidated data for identity: hello_123 with 2 items","service":"clevertap-processor","timestamp":"2025-06-09T11:20:02.225Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-09T11:20:02.858Z"}
{"level":"info","message":"Sending consolidated data for identity: 32rfwq with 1 items","service":"clevertap-processor","timestamp":"2025-06-09T11:20:02.959Z"}
{"level":"info","message":"CleverTap API success for identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-09T11:20:03.518Z"}
{"level":"info","message":"Sending consolidated data for identity: furni2 with 2 items","service":"clevertap-processor","timestamp":"2025-06-09T11:20:03.620Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-09T11:20:04.276Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":4,"timestamp":"2025-06-09T11:20:04.378Z","totalRecords":6,"uniqueIdentities":4}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-09T11:20:22.309Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:59:28.073Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-09T11:59:28.147Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-09T11:59:28.148Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:59:28.148Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-09T11:59:28.148Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.269Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.271Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.847Z"}
{"level":"info","message":"Searching for files with dates: 20250609, 20250608, 20250607, 20250606, 20250605, 20250604, 20250603","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.847Z"}
{"level":"info","message":"Found 4 files in cart-abandon","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.848Z"}
{"level":"info","message":"Processing file: 1749191222-1749191222-AddToCart-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:00.848Z"}
{"level":"info","message":"Processing file: 1749191222-1749191222-AddToCart-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:01.028Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:01.207Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:01.402Z"}
{"level":"info","message":"Total records processed from cart-abandon: 10","service":"clevertap-processor","timestamp":"2025-06-09T12:01:01.581Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.180Z"}
{"level":"info","message":"Searching for files with dates: 20250609, 20250608, 20250607, 20250606, 20250605, 20250604, 20250603","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.181Z"}
{"level":"info","message":"Found 4 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.181Z"}
{"level":"info","message":"Processing file: 1749191356-1749191356-Charged-20250604-0-16.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.181Z"}
{"level":"info","message":"Processing file: 1749191356-1749191356-Charged-20250604-0-21.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.340Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.521Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.684Z"}
{"level":"info","message":"Total records processed from charged-events: 6","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.863Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.864Z"}
{"level":"info","message":"Total records received: 10","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.864Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"ts: 20250604223048","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.865Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.866Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"ts: 20250604223132","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.867Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.868Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.869Z"}
{"level":"info","message":"eventProps.product_id: 123d","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"Total records received: 6","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"ts: 20250604223153","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.870Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.871Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.872Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.873Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.874Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.874Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.874Z"}
{"level":"info","message":"ts: 20250604223236","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.all_identities: [testing.developer@gmail.com, hello_321]","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.email: testing.developer@gmail.com","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.875Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.product_id: 123c","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.876Z"}
{"level":"info","message":"Valid cart abandon records after null check: 10","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Valid charged combinations: 5","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Original cart abandon records: 10","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Valid cart abandon records: 10","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Charged events records: 6","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Valid charged combinations: 5","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Delta records (before deduplication): 6","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Final delta records: 6","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:01:02.877Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:01:03.514Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:01:03.514Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 6 records in 3243ms","service":"clevertap-processor","timestamp":"2025-06-09T12:01:03.514Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-09T12:02:00.392Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-09T12:02:00.882Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:02:00.882Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:02:00.882Z"}
{"level":"info","message":"Successfully downloaded and parsed 6 records from delta-events/delta_2025-06-09T12-01-02-877Z.csv","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.044Z"}
{"level":"info","message":"Extracted 6 valid profiles from 6 records","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.044Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.046Z"}
{"level":"info","message":"Grouped 6 records into 4 unique identities","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.046Z"}
{"level":"info","message":"Sample consolidated profile:","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.046Z"}
{"level":"info","message":"Sending consolidated data for identity: hello_321 with 1 items","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.046Z"}
{"level":"info","message":"CleverTap API success for identity: hello_321","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.256Z"}
{"level":"info","message":"Sending consolidated data for identity: hello_123 with 2 items","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.358Z"}
{"level":"info","message":"CleverTap API success for identity: hello_123","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.516Z"}
{"level":"info","message":"Sending consolidated data for identity: 32rfwq with 1 items","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.617Z"}
{"level":"info","message":"CleverTap API success for identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.768Z"}
{"level":"info","message":"Sending consolidated data for identity: furni2 with 2 items","service":"clevertap-processor","timestamp":"2025-06-09T12:02:01.869Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-09T12:02:02.038Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":4,"timestamp":"2025-06-09T12:02:02.140Z","totalRecords":6,"uniqueIdentities":4}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-09T12:03:59.736Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-10T06:18:00.534Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-10T06:18:00.572Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-10T06:18:00.572Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-10T06:18:00.572Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-10T06:18:00.572Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-10T06:19:00.641Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-10T06:19:00.642Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.203Z"}
{"level":"info","message":"Searching for files with dates: 20250610","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.203Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250610) in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.203Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Searching for files with dates: 20250610","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250610) in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Valid cart abandon records after null check: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Original cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Valid cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Charged events records: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Final delta records: 0","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 0 records in 1101ms","service":"clevertap-processor","timestamp":"2025-06-10T06:19:01.743Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-10T06:20:00.735Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-10T06:20:01.309Z"}
{"level":"warn","message":"No CSV files found for today (2025-06-10) in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-10T06:20:01.309Z"}
{"level":"info","message":"No delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-10T06:20:01.309Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-10T06:40:58.191Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:47:16.493Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:47:16.554Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T05:47:16.554Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:47:16.554Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:47:16.555Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T05:47:20.910Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:47:30.678Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:47:30.713Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T05:47:30.714Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:47:30.714Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:47:30.714Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-11T05:49:00.814Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-11T05:49:00.816Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","httpStatusCode":403,"requestId":"TD2NPEAVY0DZZ14S","totalRetryDelay":0},"Code":"AccessDenied","HostId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","RequestId":"TD2NPEAVY0DZZ14S","level":"error","message":"Error listing objects in bucket cart-abandon: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:49:01.479Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","httpStatusCode":403,"requestId":"TD2NPEAVY0DZZ14S","totalRetryDelay":0},"Code":"AccessDenied","HostId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","RequestId":"TD2NPEAVY0DZZ14S","level":"error","message":"Error fetching CSV data from cart-abandon: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:49:01.480Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","httpStatusCode":403,"requestId":"TD2NPEAVY0DZZ14S","totalRetryDelay":0},"Code":"AccessDenied","HostId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","RequestId":"TD2NPEAVY0DZZ14S","level":"error","message":"Cron Job 1 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:49:01.481Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","httpStatusCode":403,"requestId":"TD2NPEAVY0DZZ14S","totalRetryDelay":0},"Code":"AccessDenied","HostId":"xpNoertov03tKm6NJ/hHNyB8bSAyvNSpxUFSDrDm5QoiqYgrvNE/rbABmG6Cf6/CShTt6ZxLKxqhpJzxhydAPw==","RequestId":"TD2NPEAVY0DZZ14S","level":"error","message":"Scheduled Cron Job 1 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::cart-abandon\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:49:01.481Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-11T05:50:00.927Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","httpStatusCode":403,"requestId":"0QNRMN7G0KWD50CB","totalRetryDelay":0},"Code":"AccessDenied","HostId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","RequestId":"0QNRMN7G0KWD50CB","level":"error","message":"Error listing objects in bucket delta-events: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:50:01.578Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","httpStatusCode":403,"requestId":"0QNRMN7G0KWD50CB","totalRetryDelay":0},"Code":"AccessDenied","HostId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","RequestId":"0QNRMN7G0KWD50CB","level":"error","message":"Error fetching delta CSV data: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:50:01.578Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","httpStatusCode":403,"requestId":"0QNRMN7G0KWD50CB","totalRetryDelay":0},"Code":"AccessDenied","HostId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","RequestId":"0QNRMN7G0KWD50CB","level":"error","message":"Cron Job 2 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:50:01.578Z"}
{"$fault":"client","$metadata":{"attempts":1,"extendedRequestId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","httpStatusCode":403,"requestId":"0QNRMN7G0KWD50CB","totalRetryDelay":0},"Code":"AccessDenied","HostId":"4pp9i0BHLSbdCWLxPnR/IR/MZTdAwgvQ1Echk8Mean9TyJ7NtiGvc2hvQ+tLnyVFW1WbdKS8qwki3tMVDJk5L274EvtEoqpn","RequestId":"0QNRMN7G0KWD50CB","level":"error","message":"Scheduled Cron Job 2 failed: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy","name":"AccessDenied","service":"clevertap-processor","stack":"AccessDenied: User: arn:aws:iam::666908824322:user/Dev-Clevertap is not authorized to perform: s3:ListBucket on resource: \"arn:aws:s3:::delta-events\" with an explicit deny in an identity-based policy\n    at throwDefaultError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:388:20)\n    at /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/smithy-client/dist-cjs/index.js:397:5\n    at de_CommandError (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/client-s3/dist-cjs/index.js:4953:14)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:484:18\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14\n    at async /Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22","timestamp":"2025-06-11T05:50:01.579Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T05:53:46.586Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:54:03.215Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:54:03.269Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T05:54:03.269Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:54:03.269Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:54:03.269Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T05:54:15.116Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:54:17.392Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:54:17.432Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T05:54:17.432Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:54:17.432Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:54:17.432Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-11T05:55:00.527Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-11T05:55:00.528Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.212Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.212Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250611) in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.213Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.837Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.838Z"}
{"level":"warn","message":"No .csv.gz files found for dates (20250611) in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.838Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Total records received: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Valid cart abandon records after null check: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Original cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Valid cart abandon records: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Charged events records: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Valid charged combinations: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Delta records (before deduplication): 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Final delta records: 0","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"No delta data to process. Cron Job 1 completed.","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 0 records in 1311ms","service":"clevertap-processor","timestamp":"2025-06-11T05:55:01.839Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T05:55:07.538Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:55:27.383Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T05:55:27.438Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T05:55:27.438Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:55:27.438Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T05:55:27.438Z"}
{"level":"info","message":"Executing scheduled Cron Job 1 at 4:15 PM","service":"clevertap-processor","timestamp":"2025-06-11T05:56:00.478Z"}
{"level":"info","message":"Starting Cron Job 1 - Data Processing","service":"clevertap-processor","timestamp":"2025-06-11T05:56:00.478Z"}
{"level":"info","message":"Successfully listed objects in bucket: cart-abandon","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.134Z"}
{"level":"info","message":"Searching for files with dates: 20250611, 20250610, 20250609, 20250608, 20250607, 20250606, 20250605","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.134Z"}
{"level":"info","message":"Found 2 files in cart-abandon","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.134Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.134Z"}
{"level":"info","message":"Processing file: 1749192519-1749192519-AddToCart-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.358Z"}
{"level":"info","message":"Total records processed from cart-abandon: 5","service":"clevertap-processor","timestamp":"2025-06-11T05:56:01.576Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.184Z"}
{"level":"info","message":"Searching for files with dates: 20250611, 20250610, 20250609, 20250608, 20250607, 20250606, 20250605","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.184Z"}
{"level":"info","message":"Found 2 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.184Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-15.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.184Z"}
{"level":"info","message":"Processing file: 1749192537-1749192537-Charged-20250606-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.706Z"}
{"level":"info","message":"Total records processed from charged-events: 2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"\n=== Cart Abandon Data Details ===","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"Total records received: 5","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"\nCart Abandon - Available fields:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"\nDetailed Cart Abandon Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"ts: 20250606121411","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.964Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.product_id: 123a","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"ts: 20250606121427","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventName: AddToCart","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"\n=== Charged Events Data Details ===","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"Total records received: 2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"\nCharged Events - Available fields:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"\nDetailed Charged Events Data (up to 2 rows):","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"\nRow 1:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"ts: 20250606121454","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.all_identities: [32rfwq, iouwfhkbjn@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.email: iouwfhkbjn@gmail.com","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"profile.push_token: fcm:eI3CwZuQTKuAhuXoGetNkM:APA91bGYr-jfCQ-BO4bINH9gMrio6hLlLAHQ_UMzGLm7KPsNRNZAuy3t9Cmwrfn4Pppx3ix40stEHIVq6G4NSY1UxkbB5UDhfltNaHUKR_ats4CsL_bIjYE","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.965Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"\nRow 2:","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"ts: 20250606121214","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventName: Charged","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.identity: furni2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.objectId: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.all_identities: [furni2, dedededed@gmail.com]","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.platform: Android","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.phone: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.name: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.email: dedededed@gmail.com","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"profile.push_token: fcm:c4S5zE_XQrSv5M5xPzg-xQ:APA91bFUuxaVGCeGyoN4ymgjd_lfw-6GhLtAjJxRxZpzubeOCCR07ddhcjmp1ZFAZKanCtPX1z6T4AQ3puYNIttFGq_QMHU2Zgbj2hRfVQ4h4h9J03tlY8A","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.make: Google","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.model: Sdk_gphone64_arm64","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.appVersion: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.sdkVersion: 70301","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.osVersion: 16","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.browser: MobileApp","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dpi: 480","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.width: 61","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.height: 143","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"deviceInfo.dimensions.unit: mm","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"controlGroupName: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.CT App Version: 1.0.0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.CT Source: Mobile","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.price: 3499","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.image_url: https://fastly.picsum.photos/id/935/200/300.jpg?hmac=XPPjHEBtYb6Y3-p1EjAP0RRB0bNlvqCs52VIysO7iH0","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.product_id: 123b","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.966Z"}
{"level":"info","message":"eventProps.Items: ","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Valid cart abandon records after null check: 5","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"\n=== Processing Summary ===","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Original cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Valid cart abandon records: 5","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Charged events records: 2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Valid charged combinations: 2","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Delta records (before deduplication): 3","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Final delta records: 3","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:56:02.967Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:56:03.715Z"}
{"level":"info","message":"Delta data uploaded successfully: delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:56:03.715Z"}
{"level":"info","message":"Cron Job 1 completed successfully. Processed 3 records in 3237ms","service":"clevertap-processor","timestamp":"2025-06-11T05:56:03.715Z"}
{"level":"info","message":"Executing scheduled Cron Job 2 at 4:18 PM","service":"clevertap-processor","timestamp":"2025-06-11T05:57:00.586Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.592Z"}
{"level":"info","message":"Processing latest delta file: delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.592Z"}
{"level":"info","message":"Downloading CSV from delta-events/delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.592Z"}
{"level":"info","message":"Successfully downloaded and parsed 3 records from delta-events/delta_2025-06-11T05-56-02-967Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.813Z"}
{"level":"info","message":"Extracted 3 valid profiles from 3 records","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.813Z"}
{"level":"info","message":"Sample profile data:","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.814Z"}
{"level":"info","message":"Grouped 3 records into 2 unique identities","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.814Z"}
{"level":"info","message":"Sample consolidated profile:","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.814Z"}
{"level":"info","message":"Sending consolidated data for identity: 32rfwq with 1 items","service":"clevertap-processor","timestamp":"2025-06-11T05:57:01.814Z"}
{"level":"info","message":"CleverTap API success for identity: 32rfwq","service":"clevertap-processor","timestamp":"2025-06-11T05:57:02.075Z"}
{"level":"info","message":"Sending consolidated data for identity: furni2 with 2 items","service":"clevertap-processor","timestamp":"2025-06-11T05:57:02.176Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-11T05:57:02.337Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":2,"timestamp":"2025-06-11T05:57:02.458Z","totalRecords":3,"uniqueIdentities":2}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T05:57:44.097Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.083Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T06:53:46.162Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T06:55:00.249Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T06:55:00.251Z"}
{"level":"error","message":"Error processing product view data: Cannot read properties of undefined (reading 'forEach')","service":"clevertap-processor","stack":"TypeError: Cannot read properties of undefined (reading 'forEach')\n    at CronJob3.processProductViewData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:60:29)\n    at CronJob3.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:30:42)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:69:9)","timestamp":"2025-06-11T06:55:00.254Z"}
{"level":"error","message":"Cron Job 3 failed: Cannot read properties of undefined (reading 'forEach')","service":"clevertap-processor","stack":"TypeError: Cannot read properties of undefined (reading 'forEach')\n    at CronJob3.processProductViewData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:60:29)\n    at CronJob3.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:30:42)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:69:9)","timestamp":"2025-06-11T06:55:00.255Z"}
{"level":"error","message":"Scheduled Cron Job 3 failed: Cannot read properties of undefined (reading 'forEach')","service":"clevertap-processor","stack":"TypeError: Cannot read properties of undefined (reading 'forEach')\n    at CronJob3.processProductViewData (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:60:29)\n    at CronJob3.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob3.js:30:42)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runNextTicks (node:internal/process/task_queues:69:3)\n    at listOnTimeout (node:internal/timers:569:9)\n    at process.processTimers (node:internal/timers:543:7)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:69:9)","timestamp":"2025-06-11T06:55:00.255Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T06:56:00.315Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T06:56:01.032Z"}
{"level":"info","message":"No most viewed delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-11T06:56:01.032Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T07:00:04.062Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.604Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:05.677Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T07:00:14.389Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.149Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:00:16.198Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:01:00.247Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T07:01:00.250Z"}
{"level":"warn","message":"No product view data found or invalid format","service":"clevertap-processor","timestamp":"2025-06-11T07:01:00.250Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:02:00.322Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T07:02:00.907Z"}
{"level":"info","message":"No most viewed delta data found for CleverTap upload","service":"clevertap-processor","timestamp":"2025-06-11T07:02:00.907Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T07:02:20.872Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.189Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:02:23.240Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:04:00.352Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T07:04:00.357Z"}
{"level":"info","message":"Successfully listed objects in bucket: product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.040Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.041Z"}
{"level":"info","message":"Found 1 files in product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.041Z"}
{"level":"info","message":"Processing file: 1749623187-1749623187-Product-Viewed-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.041Z"}
{"level":"info","message":"Total records processed from product-viewed: 11","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.229Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.796Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.796Z"}
{"level":"info","message":"Found 1 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.796Z"}
{"level":"info","message":"Processing file: 1749624344-1749624344-Charged-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.796Z"}
{"level":"info","message":"Total records processed from charged-events: 1","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.988Z"}
{"level":"info","message":"Processing 11 product views and 1 charged events","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.988Z"}
{"level":"info","message":"Processed 2 unique user-product combinations","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.989Z"}
{"level":"info","message":"Found 1 products with 5+ views","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.989Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/most_viewed_delta_2025-06-11T07-04-01-989Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:04:01.989Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/most_viewed_delta_2025-06-11T07-04-01-989Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:04:02.736Z"}
{"level":"info","message":"Most viewed delta data uploaded successfully: most_viewed_delta_2025-06-11T07-04-01-989Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:04:02.736Z"}
{"level":"info","message":"Cron Job 3 completed successfully. Processed 1 records in 2379ms","service":"clevertap-processor","timestamp":"2025-06-11T07:04:02.736Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:05:00.460Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T07:05:01.091Z"}
{"level":"info","message":"Downloading CSV from delta-events/most_viewed_delta_2025-06-11T07-04-01-989Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:05:01.092Z"}
{"level":"info","message":"Successfully downloaded and parsed 1 records from delta-events/most_viewed_delta_2025-06-11T07-04-01-989Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:05:01.283Z"}
{"level":"error","message":"Cron Job 4 failed: cleverTapService.batchSendEvents is not a function","service":"clevertap-processor","stack":"TypeError: cleverTapService.batchSendEvents is not a function\n    at CronJob4.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob4.js:65:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:82:9)","timestamp":"2025-06-11T07:05:01.284Z"}
{"level":"error","message":"Scheduled Cron Job 4 failed: cleverTapService.batchSendEvents is not a function","service":"clevertap-processor","stack":"TypeError: cleverTapService.batchSendEvents is not a function\n    at CronJob4.execute (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/jobs/cronJob4.js:65:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cron.schedule.scheduled [as _execution] (/Users/dev.bathani/Desktop/Work/s3-delta-clevertap-app/src/index.js:82:9)","timestamp":"2025-06-11T07:05:01.285Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T07:08:37.318Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.408Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:00.486Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T07:23:08.264Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.933Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.975Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.975Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.975Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.975Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.976Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T07:23:10.976Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.050Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.051Z"}
{"level":"info","message":"Successfully listed objects in bucket: product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.605Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.606Z"}
{"level":"info","message":"Found 1 files in product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.606Z"}
{"level":"info","message":"Processing file: 1749623187-1749623187-Product-Viewed-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.606Z"}
{"level":"info","message":"Total records processed from product-viewed: 11","service":"clevertap-processor","timestamp":"2025-06-11T07:24:00.792Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.320Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.321Z"}
{"level":"info","message":"Found 1 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.321Z"}
{"level":"info","message":"Processing file: 1749624344-1749624344-Charged-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.321Z"}
{"level":"info","message":"Total records processed from charged-events: 1","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.498Z"}
{"level":"info","message":"Processing 11 product views and 1 charged events","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.498Z"}
{"level":"info","message":"Processed 2 unique user-product combinations","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.498Z"}
{"level":"info","message":"Found 1 products with 5+ views","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.498Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/most_viewed_delta_2025-06-11T07-24-01-498Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:24:01.499Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/most_viewed_delta_2025-06-11T07-24-01-498Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:24:02.283Z"}
{"level":"info","message":"Most viewed delta data uploaded successfully: most_viewed_delta_2025-06-11T07-24-01-498Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:24:02.283Z"}
{"level":"info","message":"Cron Job 3 completed successfully. Processed 1 records in 2232ms","service":"clevertap-processor","timestamp":"2025-06-11T07:24:02.283Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T07:25:00.139Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T07:25:00.755Z"}
{"level":"info","message":"Downloading CSV from delta-events/most_viewed_delta_2025-06-11T07-24-01-498Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:25:00.756Z"}
{"level":"info","message":"Successfully downloaded and parsed 1 records from delta-events/most_viewed_delta_2025-06-11T07-24-01-498Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T07:25:00.942Z"}
{"level":"info","message":"Sending consolidated data for identity: furni2 with 1.3333333333333333 items","service":"clevertap-processor","timestamp":"2025-06-11T07:25:00.942Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-11T07:25:01.180Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":1,"timestamp":"2025-06-11T07:25:01.281Z","totalProfiles":1}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T08:15:42.566Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.636Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:16:16.710Z"}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T08:17:57.690Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.002Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.049Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.049Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.049Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.049Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.050Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:17:59.050Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.050Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.050Z"}
{"level":"info","message":"Successfully listed objects in bucket: product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.686Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.687Z"}
{"level":"info","message":"Found 1 files in product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.687Z"}
{"level":"info","message":"Processing file: 1749623187-1749623187-Product-Viewed-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.687Z"}
{"level":"info","message":"Total records processed from product-viewed: 11","service":"clevertap-processor","timestamp":"2025-06-11T08:18:00.891Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.530Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.531Z"}
{"level":"info","message":"Found 1 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.531Z"}
{"level":"info","message":"Processing file: 1749624344-1749624344-Charged-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.531Z"}
{"level":"info","message":"Total records processed from charged-events: 1","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.709Z"}
{"level":"info","message":"Processing 11 product views and 1 charged events","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.710Z"}
{"level":"info","message":"Processed 2 unique user-product combinations","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.710Z"}
{"level":"info","message":"Found 1 products with 5+ views","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.710Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/most_viewed_delta_2025-06-11T08-18-01-710Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:18:01.711Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/most_viewed_delta_2025-06-11T08-18-01-710Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:18:02.464Z"}
{"level":"info","message":"Most viewed delta data uploaded successfully: most_viewed_delta_2025-06-11T08-18-01-710Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:18:02.464Z"}
{"level":"info","message":"Cron Job 3 completed successfully. Processed 1 records in 2414ms","service":"clevertap-processor","timestamp":"2025-06-11T08:18:02.464Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T08:19:00.148Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T08:19:00.696Z"}
{"level":"info","message":"Downloading CSV from delta-events/most_viewed_delta_2025-06-11T08-18-01-710Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:19:00.697Z"}
{"level":"info","message":"Successfully downloaded and parsed 1 records from delta-events/most_viewed_delta_2025-06-11T08-18-01-710Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:19:00.871Z"}
{"level":"info","message":"Sending MostViewedItem data for identity: furni2 with 1.3333333333333333 items","service":"clevertap-processor","timestamp":"2025-06-11T08:19:00.871Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-11T08:19:01.261Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":1,"timestamp":"2025-06-11T08:19:01.362Z","totalProfiles":1}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T08:19:39.104Z"}
{"level":"info","message":"AWS credentials validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.745Z"}
{"level":"info","message":"Environment validation passed","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.816Z"}
{"level":"info","message":"CleverTap Data Processor started successfully","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.817Z"}
{"level":"info","message":"Cron Job 1 scheduled for 4:15 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.817Z"}
{"level":"info","message":"Cron Job 2 scheduled for 4:18 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.817Z"}
{"level":"info","message":"Cron Job 3 scheduled for 4:21 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.817Z"}
{"level":"info","message":"Cron Job 4 scheduled for 4:24 PM daily","service":"clevertap-processor","timestamp":"2025-06-11T08:23:38.817Z"}
{"level":"info","message":"Executing scheduled Cron Job 3 at 4:21 PM","service":"clevertap-processor","timestamp":"2025-06-11T08:24:00.836Z"}
{"level":"info","message":"Starting Cron Job 3 - Product View Processing","service":"clevertap-processor","timestamp":"2025-06-11T08:24:00.837Z"}
{"level":"info","message":"Successfully listed objects in bucket: product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T08:24:01.399Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T08:24:01.400Z"}
{"level":"info","message":"Found 1 files in product-viewed","service":"clevertap-processor","timestamp":"2025-06-11T08:24:01.400Z"}
{"level":"info","message":"Processing file: 1749623187-1749623187-Product-Viewed-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T08:24:01.401Z"}
{"level":"info","message":"Total records processed from product-viewed: 11","service":"clevertap-processor","timestamp":"2025-06-11T08:24:01.581Z"}
{"level":"info","message":"Successfully listed objects in bucket: charged-events","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.036Z"}
{"level":"info","message":"Searching for files with dates: 20250611","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.037Z"}
{"level":"info","message":"Found 1 files in charged-events","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.037Z"}
{"level":"info","message":"Processing file: 1749624344-1749624344-Charged-20250611-0-6.csv.gz","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.037Z"}
{"level":"info","message":"Total records processed from charged-events: 1","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.213Z"}
{"level":"info","message":"Processing 11 product views and 1 charged events","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.213Z"}
{"level":"info","message":"Processed 2 unique user-product combinations","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.214Z"}
{"level":"info","message":"Found 1 products with 5+ views","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.214Z"}
{"level":"info","message":"Preparing to upload CSV to delta-events/most_viewed_delta_2025-06-11T08-24-02-214Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.214Z"}
{"level":"info","message":"Successfully uploaded CSV to delta-events/most_viewed_delta_2025-06-11T08-24-02-214Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.808Z"}
{"level":"info","message":"Most viewed delta data uploaded successfully: most_viewed_delta_2025-06-11T08-24-02-214Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.808Z"}
{"level":"info","message":"Cron Job 3 completed successfully. Processed 1 records in 1971ms","service":"clevertap-processor","timestamp":"2025-06-11T08:24:02.808Z"}
{"level":"info","message":"Executing scheduled Cron Job 4 at 4:24 PM","service":"clevertap-processor","timestamp":"2025-06-11T08:25:00.932Z"}
{"level":"info","message":"Successfully listed objects in bucket: delta-events","service":"clevertap-processor","timestamp":"2025-06-11T08:25:01.554Z"}
{"level":"info","message":"Downloading CSV from delta-events/most_viewed_delta_2025-06-11T08-24-02-214Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:25:01.554Z"}
{"level":"info","message":"Successfully downloaded and parsed 1 records from delta-events/most_viewed_delta_2025-06-11T08-24-02-214Z.csv","service":"clevertap-processor","timestamp":"2025-06-11T08:25:01.729Z"}
{"level":"info","message":"Sending MostViewedItem data for identity: furni2 with 1.3333333333333333 items","service":"clevertap-processor","timestamp":"2025-06-11T08:25:01.730Z"}
{"level":"info","message":"CleverTap API success for identity: furni2","service":"clevertap-processor","timestamp":"2025-06-11T08:25:01.962Z"}
{"errors":[],"failed":0,"level":"info","message":"CleverTap upload results:","service":"clevertap-processor","successful":1,"timestamp":"2025-06-11T08:25:02.064Z","totalProfiles":1}
{"level":"info","message":"Received SIGINT. Graceful shutdown...","service":"clevertap-processor","timestamp":"2025-06-11T08:27:18.499Z"}
